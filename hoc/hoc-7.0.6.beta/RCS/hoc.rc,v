head	1.20;
access;
symbols;
locks
	beebe:1.20; strict;
comment	@# @;


1.20
date	2002.08.08.22.37.19;	author beebe;	state Exp;
branches;
next	1.19;

1.19
date	2002.08.08.01.23.41;	author beebe;	state Exp;
branches;
next	1.18;

1.18
date	2002.08.06.13.19.16;	author beebe;	state Exp;
branches;
next	1.17;

1.17
date	2002.08.01.16.34.49;	author beebe;	state Exp;
branches;
next	1.16;

1.16
date	2002.08.01.12.21.33;	author beebe;	state Exp;
branches;
next	1.15;

1.15
date	2002.07.31.17.24.52;	author beebe;	state Exp;
branches;
next	1.14;

1.14
date	2002.07.27.17.31.36;	author beebe;	state Exp;
branches;
next	1.13;

1.13
date	2002.07.26.15.29.45;	author beebe;	state Exp;
branches;
next	1.12;

1.12
date	2002.07.20.23.04.17;	author beebe;	state Exp;
branches;
next	1.11;

1.11
date	2002.07.04.14.45.00;	author beebe;	state Exp;
branches;
next	1.10;

1.10
date	2002.06.15.22.36.43;	author beebe;	state Exp;
branches;
next	1.9;

1.9
date	2002.01.17.01.36.40;	author beebe;	state Exp;
branches;
next	1.8;

1.8
date	2002.01.16.18.47.03;	author beebe;	state Exp;
branches;
next	1.7;

1.7
date	2002.01.11.16.45.36;	author beebe;	state Exp;
branches;
next	1.6;

1.6
date	2002.01.11.02.20.03;	author beebe;	state Exp;
branches;
next	1.5;

1.5
date	2002.01.05.14.49.06;	author beebe;	state Exp;
branches;
next	1.4;

1.4
date	2002.01.04.17.53.25;	author beebe;	state Exp;
branches;
next	1.3;

1.3
date	2002.01.02.21.40.56;	author beebe;	state Exp;
branches;
next	1.2;

1.2
date	2002.01.01.14.51.47;	author beebe;	state Exp;
branches;
next	1.1;

1.1
date	2001.12.11.15.19.28;	author beebe;	state Exp;
branches;
next	;


desc
@Original version.
@


1.20
log
@Update news_hoc_7_0_6_beta().
@
text
@### -*-hoc-*-
### /usr/local/src/hoc/hoc-7.0.4.beta/hoc.rc, Sat Jun 15 16:36:36 2002
### Edit by Nelson H. F. Beebe <beebe@@math.utah.edu>
### /usr/local/src/hoc/hoc-7.0.1.beta/hoc.rc, Sun Jan  6 08:39:02 2002
### Edit by Nelson H. F. Beebe <beebe@@math.utah.edu>
### ====================================================================
###
### This is hoc.rc, the main hoc (rc == run command) initialization
### file.  Some of the documented functionality of hoc is provided by
### functions and procedures defined here, when they can be implemented
### entirely in the hoc language, since that is more flexible than
### having them hard coded in the hoc source.
###
### To support internationalization, hoc will load after this file a
### XX/hoc.rc file, where XX is the current language, determined by
### the environment variables LC_ALL, LC_MESSAGES, and LANG, in that
### order.  That file can provide replacement versions of any
### functions or procedures that print English text.  Apart from the
### text replacement, the operation of those modules must not change.
###
### [16-Dec-2001]
### ====================================================================

### Supplementary trigonometric functions with arguments in degrees:

func cosd(x) return cos(x / DEG)
func sind(x) return sin(x / DEG)
func tand(x) return tan(x / DEG)

### factorial(n) = n*(n-1)*(n-2)*...*1
func factorial(n) \
{
	n = int(n)
	if (n < 0) \
		abort("factorial() called with illegal negative argument\n") \
	if (n == 0) \
		return (1) \
	else \
	{
		return (n * factorial(n - 1))
	}
}

### Adapted from UNIX manual pages (hoc.1)
### gcd(x,y): return the greatest common denominator of integer x and integer y
func gcd(x,y) \
{
	__temp__ = abs(x) % abs(y)
	if (__temp__ == 0) return abs(y)
	return gcd(y, __temp__)
}

### lcm(x,y): return the least common multiple of integer x and integer y
func lcm(x,y) \
{
	x = int(x)
	y = int(y)
	if ((x == 0) || (y == 0)) return (0)
	return ((x * y)/gcd(x,y))
}

### logb(b,x) = log to base b of x
func logb(b,x) \
{
	return (log(x)/log(b))
}

### matula(nbits): return number of decimal digits needed to ensure
### correct round-trip conversion between binary and decimal
func matula(nbits) { return ceil(nbits/log2(10) + 1) }

### max(a,b): maximum of a and b
func max(a,b) \
{
	if (isnan(a)) \
		return (a)
	if (isnan(b)) \
		return (b)
	if (a > b) \
		return (a) \
	else \
		return (b)
}

### min(a,b): minimum of a and b
func min() \
{
	if (isnan(a)) \
		return (a)
	if (isnan(b)) \
		return (b)
	if (a < b) \
		return (a) \
	else \
		return (b)
}

proc _internal_help_hrule() \
{
	print "------------------------------------------------------------------------\n"
}

proc _internal_help_short_hrule() \
{
	print "------------------------------------\n"
}

proc author() \
{
	_internal_help_hrule()
	print "hoc is described in a series of increasingly powerful versions in this\n"
	print "book:\n\n"

	print "\tBrian W. Kernighan and Rob Pike\n"
	print "\tThe UNIX Programming Environment\n"
	print "\tPrentice-Hall\n"
	print "\t1984\n"
	print "\tpp. xii + 357\n"
	print "\tISBN 0-13-937699-2 (hardcover), 0-13-937681-X (paperback)\n"
	print "\tLCCN QA76.76.O63 K48 1984\n\n"

	print "Extensions for IEEE 754 arithmetic, help, additional constants,\n"
	print "statements, and functions, initialization files, internationalization,\n"
	print "and GNU readline support were added by:\n\n"

	print "\tNelson H. F. Beebe <beebe@@math.utah.edu>\n\n"

	print "The extended hoc master Internet source distribution site is at:\n\n"

	print "\tftp://ftp.math.utah.edu/pub/hoc\n"
	print "\thttp://www.math.utah.edu/pub/hoc/\n"
	_internal_help_hrule()
}

proc news_hoc_7_0_0_beta() \
{
	print "[26-Nov-2001]--[13-Dec-2001]: hoc-7.0.0.beta\n\n"

	print "\tBegin development work with these goals:\n\n"

	print "\t(1) Repackage 1984-vintage hoc-6 with modern automatic\n"
	print "\t    configuration and testing.\n\n"

	print "\t(2) Make extensive additions to the language and the\n"
	print "\t    run-time library, particularly for support of IEEE 754\n"
	print "\t    floating-point arithmetic.\n\n"

	print "\t(3) Serve as a testbed for work on the on-going revision of\n"
	print "\t    the 1985 IEEE 754 Standard.\n\n"

	print "\t(4) Provide an extensive help system for the hoc language\n"
	print "\t    and library.\n\n"

	print "\t(5) Provide a student interactive learning environment that\n"
	print "\t    introduces a small, easy-to-learn, subset of C/C++.\n\n"

	print "\t(6) Internationalize hoc-7 so that it can be comfortably used\n"
	print "\t    by school children in any language for which hoc message\n"
	print "\t    translations have been prepared.  All such translations\n"
	print "\t    must be external to hoc, and must be dynamically loadable.\n\n"

	print "\t(7) Make hoc-7 trivially portable to virtually all common\n"
	print "\t    desktop and handheld computing environments.\n\n"

	print "\t(8) Provide an open software development environment for\n"
	print "\t    students to learn about, and experiment with, lexing and\n"
	print "\t    parsing techniques for a small clean language.\n\n"
}

proc news_hoc_7_0_1_beta() \
{
	global __READLINE__

	print "[15-Dec-2001]: hoc-7.0.1.beta\n\n"
	print "The original Kernighan and Pike hoc (high-order calculator) has been\n"
	print "extended with additional functions, and support for features of IEEE 754\n"
	print "floating-point arithmetic.\n\n"

	print "New functions:\tacosh(x), asinh(x), atanh(x), cbrt(x), cd(s), ceil(x),\n"
	print "\t\tcopysign(x,y), cosd(x), cpulimit(x), defined(n),\n"
	print "\t\tdelete(n), dirs(), eval(s), errbits(x,y), expm1(x),\n"
	print "\t\texponent(x), factorial(x), floor(x), fmod(x,y),\n"
	print "\t\tgcd(x,y), getenv(s), hexfp(x), hexint(x), hypot(x,y),\n"
	print "\t\tilogb(x), index(s,t), isfinite(x), isinf(x), isnan(x),\n"
	print "\t\tisnormal(x), isqnan(x), issnan(x), issubnormal(x),\n"
	print "\t\tJ0(x), J1(x), Jn(n,x), Jn(x,y), lcm(x,y), ldexp(x,y),\n"
	print "\t\tlength(s), lgamma(x), load(file), log1p(x), log2(x)\n"
	print "\t\tlogfile(file), logoff(), logon(), macheps(x),\n"
	print "\t\tmax(x,y), maxnormal(), min(x,y), minnormal(),\n"
	print "\t\tminsubnormal(), msg_translate(s), nearest(x,y),\n"
	print "\t\tnextafter(x,y), nint(x), now(), number(s), popd(),\n"
	print "\t\tprintenv(prefix), protect(s), pushd(s), putenv(s,v),\n"
	print "\t\tpwd(), rand(x), randint(x,y), randl(x),\n"
	print "\t\tremainder(x,y), rint(x), rsqrt(x), save(file,prefix),\n"
	print "\t\tscalb(x,y), second(), set_locale(s), setrand(x),\n"
	print "\t\tsignificand(x), sin(x), sind(x), sinh(x), sqrt(x),\n"
	print "\t\tstrftime(s,v), string(x), substr(s,start,length),\n"
	print "\t\tsymnum(s), symstr(s), systime(), tan(x), tand(x),\n"
	print "\t\ttanh(x), tolower(s), toupper(s), trunc(x), xd(),\n"
	print "\t\tY0(x), Y1(x), Yn(n,y), and Yn(x,y).\n\n"

	print "New procedures:\tabort(), author(), who().\n\n"

	print "New command-line options:\t--?, --author, --copyright, --Dname,\n"
	print "\t\t--Dname=number, --Dname=\"string\", --Dname=symbol,\n"
	print "\t\t--help, --no-banner, --no-cd, --no-help-file,\n"
	print "\t\t--no-load, --no-logfile, --no-readline, --no-save\n"
	print "\t\t--no-site-file, --no-translation-file, --no-user-file,\n"
	print "\t\t--quick, --secure, --silent, --Uname, --version.\n\n"

	print "New constants and variables:\t_, __, __BANNER__, __CPU_LIMIT__, __DATE__,\n"
	print "\t\t__FILE__, __FILE__[*], __GID__, __HOCRC__, __IEEE_754__,\n"
	print "\t\t__LINE__, __MAX_xxx__, __PACKAGE_BUGREPORT__,\n"
	print "\t\t__PACKAGE_DATE__, __PACKAGE_NAME__, __PACKAGE_STRING__,\n"
	print "\t\t__PACKAGE_VERSION__, __PID__, __PROMPT__, __READLINE__,\n"
	print "\t\t__SYSHOCDIR__, __SYSHOCHLPBASE__, __SYSHOCHLP__,\n"
	print "\t\t__SYSHOCPATH__, __SYSHOCRCBASE__, __SYSHOCRC__,\n"
	print "\t\t__SYSHOCXLTBASE__, __SYSHOCXLT__, __TIME__, __UID__,\n"
	print "\t\t__VERBOSE__\n\n"

	print "New floating-point constants:\tCATALAN, INF, Inf, Infinity, MAXNORMAL,\n"
	print "\t\tMINNORMAL, MINSUBNORMAL, NAN, NaN, QNAN, QNaN, SNAN,\n"
	print "\t\tSNaN\n\n"

	print "New statement:\tprintln\n\n"

	print "An extensive help facility has been implemented.  For each function\n"
	print "or procedure foo(), there is a corresponding procedure help_foo().\n"
	print "There are also help_xxx() functions for various topics and language\n"
	print "features.\n\n"

	print "Limited internationalization of hoc has begun.  Set the LANG or\n"
	print "LC_MESSAGES or LC_ALL environment variable to a suitable locale code\n"
	print "before running hoc.  Currently, codes da (Danish), de (German), en\n"
	print "(English), es (Spanish), fr (French), hr (Croatian), pt (Portuguese),\n"
	print "and tr (Turkish) are supported.\n\n"

	if (__READLINE__) \
	{
		print "GNU readline support is available for convenient command completion,\n"
		print "editing, and recall.  Visit GNU emacs info node readline\n"
		print "(C-h i mreadline) for details.\n"
	}

	_internal_help_short_hrule()
}

proc news_hoc_7_0_2_beta() \
{
	print "[27-Jan-2002]: hoc-7.0.2.beta\n\n"

	print "New binary operator:\t<>\n\n"

	print "New built-in constants:\tBASE, CLASS_xxx, EBIAS, EBITS, EMAX, EMIN, and P.\n\n"

	print "New features:\thoc32, hoc80, and hoc128 now provide access to other\n"
	print "\tfloating-point precisions.  Internationalization support makes\n"
	print "\tit straightforward to provide hoc function and procedure\n"
	print "\tdocumentation in other human languages.  A numeric fortune\n"
	print "\tcookie library adds amusement.  Better support for string\n"
	print "\targuments in hoc functions and procedures.\n\n"

	print "New functions:\t__msg_translate(), class(x), find_fortune(), fortune(),\n"
	print "\tisprime(number), next_prime(number), nth_prime(n),\n"
	print "\tprev_prime(number), prime_factors(number), primes_between(i,j),\n"
	print "\tthis_or_next_prime(number), this_or_prev_prime(number),\n"
	print "\tunordered(x,y), and corresponding help_xxx() functions.\n\n"

	print "New libraries:\tfortune.hoc, primes.hoc\n"

	_internal_help_short_hrule()
}

proc news_hoc_7_0_3_beta() \
{
	print "[30-Jan-2002]: hoc-7.0.3.beta\n\n"

	print "Maintenance release:\tNo user-visible new features.\n"

	_internal_help_short_hrule()
}

proc news_hoc_7_0_4_beta() \
{
	print "[17-Jul-2002]: hoc-7.0.4.beta\n\n"

	print "New built-in constants:\t__NATIVE_xxx__.\n\n"

	print "New built-in variable:\t__INDENT__.\n\n"

	print "New features:\thoc number syntax has been extended to recognize Fortran\n"
	print "\texponent letters (D, d, Q, and q), C/C++ precision suffixes L\n"
	print "\tand l, and C/C++/Java precision suffixes F and f.  printenv(),\n"
	print "\tsave(), and who() now take a UNIX-shell-style pattern instead\n"
	print "\tof a fixed prefix.\n\n"

	print "New functions:\tdouble(x), matula(nbits), single(x).\n\n"

	print "New operators:\t** (to-the-power: synonym for ^).\n\n"

	print "New statements:\tprintf.\n\n"

	_internal_help_short_hrule()
}

proc news_hoc_7_0_5_beta() \
{
	print "[30-Jul-2002]: hoc-7.0.5.beta\n\n"

	print "New statements:\tbreak, continue, sprintf.\n\n"

	print "New functions:\tchar(), decrypt(), encrypt(), ftoh(), htof(),\n"
	print "\tand ichar().\n\n"

	print "New features:\tprintf now supports %c format descriptor.\n\n"

	_internal_help_short_hrule()
}

proc news_hoc_7_0_6_beta() \
{
	print "[09-Aug-2002]: hoc-7.0.6.beta\n\n"

	print "New functions:\tsnan()\n\n"

	print "New statement:\tglobal\n\n"

	print "New features:\tFunctions and procedures now take named arguments, and\n"
	print "\tvariables inside functions and procedures are automatically\n"
	print "\tlocal, unless declared global.  Functions may return string\n"
	print "\tvalues.\n\n"

	_internal_help_short_hrule()
}

proc news() \
{
	_internal_help_hrule()

	news_hoc_7_0_6_beta()
	news_hoc_7_0_5_beta()
	news_hoc_7_0_4_beta()
	news_hoc_7_0_3_beta()
	news_hoc_7_0_2_beta()
	news_hoc_7_0_1_beta()
	news_hoc_7_0_0_beta()

	_internal_help_hrule()
}

proc _internal_welcome() \
{
	global __IEEE_754__, __PACKAGE_NAME__, __PACKAGE_VERSION__, __PACKAGE_DATE__
	_internal_help_hrule()
	print "Welcome to the extensible high-order calculator, hoc.\n"
	print "This is", __PACKAGE_NAME__, "version", __PACKAGE_VERSION__, "[" __PACKAGE_DATE__ "].\n"
	print "Type help() for help, news() for news, and author() for author\n"
	print "information.\n"
	if (__IEEE_754__) \
		print "This system supports IEEE 754 floating-point arithmetic.\n" \
	else \
		print "This system does NOT support IEEE 754 floating-point arithmetic.\n"
	_internal_help_hrule()
}

### Miscellaneous new functions:

func hassubnormals() return issubnormal(macheps(0))

func errbits(x,y) \
{
	## errbits(x,y), with y an approximation to x, returns the
	## number of bits that y is in error by
	if (x == y) \
		return (0) \
	else \
		return (ceil(log2(abs((x - y)/max(x,y))/macheps(x))))
}

### This is now available as MAXNORMAL
func maxnormal() \
{
	global __IEEE_754__
	## Return the maximum positive normal number
	if (__IEEE_754__) \
		return (((1 - 2^(-53)) * 2^1023) * 2) \
	else \
		abort("maxnormal() not yet implemented for this platform")
}

### This is now available as MINNORMAL
func minnormal() \
{
	global __IEEE_754__
	## Return the minimum positive normal number
	if (__IEEE_754__) \
		return (2^(-1022)) \
	else \
		abort("minnormal() not yet implemented for this platform")
}

### This is now available as MINSUBNORMAL
func minsubnormal() \
{
	global __IEEE_754__
	## Return the minimimum subnormal number.  If subnormals are
	## not supported, then return the minimim normal number
	## instead.
	if (__IEEE_754__) \
	{
		if (hassubnormals()) \
			return (2^(-1074)) \
		else \
			return (minnormal())
	} \
	else \
		abort("maxnormal() not yet implemented for this platform")
}

### Define some convenient functions for switching languages inside hoc

__LANG__ = "en"

proc set_locale() \
{
	global __BANNER__, __LANG__
	__OLD_BANNER__ = __BANNER__
	__OLD_LANG__ = putenv("LANG",__LANG__)
	load(__SYSHOCDIR__ "/locale/" __LANG__ "/hoc.rc")
	load(__SYSHOCDIR__ "/locale/" __LANG__ "/help.hoc")
	load(__SYSHOCDIR__ "/locale/" __LANG__ "/translations.hoc")
	__BANNER__ = __OLD_BANNER__
}

proc danish ()		{ __LANG__ = "da"; set_locale() }
proc dansk ()		{ danish() }	# da
proc da()		{ danish() }	# ISO

proc english()		{ __LANG__ = "en"; set_locale() }
proc anglais()		{ english() }	# fr
proc en()		{ english() }	# ISO
proc engelsk()		{ english() }	# da
proc englisch()		{ english() }	# de
proc inglés()		{ english() }	# es
proc inglês()		{ english() }	# pt
proc ingles()		{ english() }	# simplified es/pt
proc ingilizce()	{ english() }	# tr

## TO DO: Add Turkish names for English

proc french ()		{ __LANG__ = "fr"; set_locale() }
proc francais ()	{ french() }	# simplified fr
proc français ()	{ french() }	# fr
proc fr()		{ french() }	# ISO

proc german()		{ __LANG__ = "de"; set_locale() }
proc deutsch()		{ german() }	# de
proc de()		{ german() }	# ISO

proc croatian()		{ __LANG__ = "hr"; set_locale() }
proc hr()		{ croatian() }	# ISO

proc portuguese()	{ __LANG__ = "pt"; set_locale() }
proc portuguesa()	{ portuguese() } # pt
proc pt()		{ portuguese() } # ISO

proc spanish()		{ __LANG__ = "es"; set_locale() }
proc espanol()		{ spanish() }	# simplified es
proc español()		{ spanish() }	# es
proc es()		{ spanish() }	# ISO

proc turkish()		{ __LANG__ ="tr"; set_locale() }
proc türkçe()		{ turkish() }	# tr
proc turkce()		{ turkish() }	# simplified tr
proc tr()		{ turkish() }	# ISO

### Create some (silly) synonyms for exit()
proc bailout(msg)	exit($$1)
proc bye(msg)		exit($$1)
proc byebye(msg)	exit($$1)
proc ciao(msg)		exit($$1)
proc goodbye(msg)	exit($$1)
proc quit(msg)		exit($$1)

### Support libraries whose code is documented in help.hoc:
load("pushd")

### Print a welcome banner if option --no-banner was not specified:
if (__BANNER__) _internal_welcome()
@


1.19
log
@Add some needed global statements.
@
text
@d328 4
a331 3
	print "New features:\tFunctions and procedures now take named\n"
	print "\targuments, and variables inside functions and procedures are\n"
	print "\tautomatically local, unless declared global.\n\n"
@


1.18
log
@Update functions and procedures to used named, rather than numbered,
arguments.
@
text
@d352 1
a352 1
	global __PACKAGE_NAME__, __PACKAGE_VERSION__, __PACKAGE_DATE__
d382 1
d393 1
d404 1
@


1.17
log
@Rename misnamed __LINENO__ to __LINE__.
@
text
@d26 3
a28 3
func cosd() return cos($1 / DEG)
func sind() return sin($1 / DEG)
func tand() return tan($1 / DEG)
d31 1
a31 1
func factorial() \
d33 2
a34 2
	$1 = int($1)
	if ($1 < 0) \
d36 1
a36 1
	if ($1 == 0) \
d40 1
a40 1
		return ($1 * factorial($1 - 1))
a43 17
### isfinite(x): return 1 (true) if x is finite, and 0 (false) otherwise
#func isfinite() \
#{
#	if (isnan($1)) \
#		return (0)
#	if (isinf($1)) \
#		return (0)
#	return (1)
#}

### isnormal(x): return 1 (true) if x is finite and normalized and not
### subnormal, and 0 (false) otherwise
#func isnormal() \
#{
#	return (isfinite(x) && !issubnormal(x))
#}

d46 1
a46 1
func gcd() \
d48 3
a50 3
	__temp__ = abs($1) % abs($2)
	if (__temp__ == 0) return abs($2)
	return gcd($2, __temp__)
d54 1
a54 1
func lcm() \
d56 4
a59 4
	$1 = int($1)
	$2 = int($2)
	if (($1 == 0) || ($2 == 0)) return (0)
	return (($1 * $2)/gcd($1,$2))
d63 1
a63 1
func logb() \
d65 1
a65 2

	return (log($2)/log($1))
a67 37
### macheps(x): return the generalized machine epsilon of x
### [16-Dec-2001]: Moved code into hoc kernel in math.c, since we
### 		   now need it for other purposes there
### OLD	func macheps() \
### OLD	{
### OLD		## NB: This code guarantees these results:
### OLD		##	macheps(Inf)  -> NaN
### OLD		##	macheps(-Inf) -> NaN
### OLD		##	macheps(NaN)  -> NaN
### OLD		##	macheps(-NaN) -> -NaN
### OLD
### OLD		__x = $1
### OLD		if (isnan(__x)) \
### OLD			return (__x)
### OLD
### OLD		if (isinf(__x)) \
### OLD			return (NaN)
### OLD
### OLD		if (__x == 0) \
### OLD			__epsilon = 1.0 \
### OLD		else \
### OLD			__epsilon = abs(__x)
### OLD
### OLD		while ((__x + __epsilon/2.0) != __x) \
### OLD			__epsilon /= 2.0
### OLD
### OLD		# purify __epsilon to eliminate all but high-order bit
### OLD		__temp = __x + __epsilon
### OLD		if (isinf(__temp)) \
### OLD		{	# x == MAXNORMAL: avoid overflow in purification
### OLD			__epsilon = __x + (__epsilon - __x)
### OLD		} \
### OLD		else \
### OLD			__epsilon = __temp - __x
### OLD		return (__epsilon)
### OLD	}

d70 1
a70 1
func matula() { return ceil($1/log2(10) + 1) }
d73 1
a73 1
func max() \
d75 6
a80 6
	if (isnan($1)) \
		return ($1)
	if (isnan($2)) \
		return ($2)
	if ($1 > $2) \
		return ($1) \
d82 1
a82 1
		return ($2)
d88 6
a93 6
	if (isnan($1)) \
		return ($1)
	if (isnan($2)) \
		return ($2)
	if ($1 < $2) \
		return ($1) \
d95 1
a95 1
		return ($2)
d172 2
d293 3
a295 1
	print "\tand l, and C/C++/Java precision suffixes F and f.\n\n"
a302 3
	print "\tprintenv(), save(), and who() now take a UNIX-shell-style pattern\n"
	print "\tinstead of a fixed prefix.\n\n"

d310 1
a310 1
	print "\tNew statements:\tbreak, continue, sprintf.\n\n"
d312 1
a312 1
	print "\tNew functions:\tchar(), decrypt(), encrypt(), ftoh(), htof(),\n"
d315 1
a315 1
	print "\tNew features:\tprintf now supports %c format descriptor.\n\n"
d324 9
a332 1
	print "\tNew functions:\tsnan()\n"
d352 1
d369 1
a369 1
func errbits() \
d373 1
a373 1
	if ($1 == $2) \
d376 1
a376 1
		return (ceil(log2(abs(($1 - $2)/max($1,$2))/macheps($1))))
d422 1
d474 6
a479 6
proc bailout()		exit($$1)
proc bye()		exit($$1)
proc byebye()		exit($$1)
proc ciao()		exit($$1)
proc goodbye()		exit($$1)
proc quit()		exit($$1)
@


1.16
log
@Add news_hoc_7_0_6_beta().
@
text
@d266 1
a266 1
	print "\t\t__LINENO__, __MAX_xxx__, __PACKAGE_BUGREPORT__,\n"
@


1.15
log
@Update date and version number in banner, and update feature list in
news_hoc_7_0_5_beta().
@
text
@d374 7
d385 1
@


1.14
log
@Update set_locale() to reflect the new installation directory path for
locale files.
@
text
@d362 1
a362 1
	print "[26-Jul-2002]: hoc-7.0.5.beta\n\n"
d364 1
a364 1
	print "\tNew statements:\tbreak, continue.\n\n"
d366 2
a367 1
	print "\tNew functions:\tchar(), ichar().\n\n"
@


1.13
log
@Split body of news() into version-specific functions: news_hoc_7_0_0_beta(),
news_hoc_7_0_1_beta(), ....  Add new content for news_hoc_7_0_0_beta().
Update comment about the loading of locale-specific help files.
@
text
@a458 1
#	__BANNER__ = 0
d460 3
a462 3
	load(__SYSHOCDIR__ "/" __LANG__ "/hoc.rc")
	load(__SYSHOCDIR__ "/" __LANG__ "/help.hoc")
	load(__SYSHOCDIR__ "/" __LANG__ "/translations.hoc")
@


1.12
log
@Update news().

Remove spaces at end of intermediate print/println strings; hoc now
supplies them.
@
text
@d15 1
a15 1
### hoc.rc.XX file, where XX is the current language, determined by
d190 1
a190 1
proc news() \
d192 1
a192 1
	_internal_help_hrule()
d194 1
a194 1
	print "[17-Jul-2002]: hoc-7.0.4.beta\n\n"
d196 2
a197 1
	print "New built-in constants:\t__NATIVE_xxx__.\n\n"
d199 3
a201 1
	print "New built-in variable:\t__INDENT__.\n\n"
d203 2
a204 3
	print "New features:\thoc number syntax has been extended to recognize Fortran\n"
	print "\texponent letters (D, d, Q, and q), C/C++ precision suffixes L\n"
	print "\tand l, and C/C++/Java precision suffixes F and f.\n\n"
d206 2
a207 1
	print "New functions:\tdouble(x), matula(nbits), single(x).\n\n"
d209 2
a210 1
	print "New operators:\t** (to-the-power: synonym for ^).\n\n"
d212 4
a215 1
	print "New statements:\tprintf.\n\n"
d217 2
a218 2
	print "\tprintenv(), save(), and who() now take a UNIX-shell-style pattern\n"
	print "\tinstead of a fixed prefix.\n\n"
d220 4
a223 30
	_internal_help_short_hrule()

	print "[30-Jan-2002]: hoc-7.0.3.beta\n\n"

	print "Maintenance release:\tNo user-visible new features.\n"

	_internal_help_short_hrule()

	print "[27-Jan-2002]: hoc-7.0.2.beta\n\n"

	print "New binary operator:\t<>\n\n"

	print "New built-in constants:\tBASE, CLASS_xxx, EBIAS, EBITS, EMAX, EMIN, and P.\n\n"

	print "New features:\thoc32, hoc80, and hoc128 now provide access to other\n"
	print "\tfloating-point precisions.  Internationalization support makes\n"
	print "\tit straightforward to provide hoc function and procedure\n"
	print "\tdocumentation in other human languages.  A numeric fortune\n"
	print "\tcookie library adds amusement.  Better support for string\n"
	print "\targuments in hoc functions and procedures.\n\n"

	print "New functions:\t__msg_translate(), class(x), find_fortune(), fortune(),\n"
	print "\tisprime(number), next_prime(number), nth_prime(n),\n"
	print "\tprev_prime(number), prime_factors(number), primes_between(i,j),\n"
	print "\tthis_or_next_prime(number), this_or_prev_prime(number),\n"
	print "\tunordered(x,y), and corresponding help_xxx() functions.\n\n"

	print "New libraries:\tfortune.hoc, primes.hoc\n"

	_internal_help_short_hrule()
d225 2
d297 87
@


1.11
log
@Update version date and add message about new __NATIVE_xxx__ constants.
@
text
@d123 3
d194 1
a194 1
	print "[22-Jun-2002]: hoc-7.0.4.beta\n\n"
d196 1
a196 1
	print "New functions:\tdouble(x), single(x).\n\n"
d198 1
a198 1
	print "New built-in constants:\t__NATIVE_xxx__.\n\n"
d204 9
d321 1
a321 1
	print "This is ", __PACKAGE_NAME__, " version ", __PACKAGE_VERSION__, " [", __PACKAGE_DATE__, "].\n"
@


1.10
log
@Update with news() entries for hoc-7.0.[234].beta.
Add procedure _internal_help_short_hrule().
Standardize space vs tab after colon on section headings.
@
text
@d191 1
a191 1
	print "[15-Jun-2002]: hoc-7.0.4.beta\n\n"
d195 2
@


1.9
log
@Routine update
@
text
@d2 2
d155 5
d190 41
a230 1
	print "[15-Dec-2001]\n"
a234 1

d258 1
a258 1
	print "New procedures: abort(), author(), who().\n\n"
d260 1
a260 1
	print "New command-line options: --?, --author, --copyright, --Dname,\n"
d267 1
a267 1
	print "New constants and variables: _, __, __BANNER__, __CPU_LIMIT__, __DATE__,\n"
d277 1
a277 1
	print "New floating-point constants:  CATALAN, INF, Inf, Infinity, MAXNORMAL,\n"
d281 1
a281 1
	print "New statement: println\n\n"
@


1.8
log
@Rename __set_locale() to set_locale().
@
text
@d188 18
a205 15
	print "New functions:\tacosh(x), asinh(x), atanh(x), cbrt(x), ceil(x),\n"
	print "\t\tcopysign(x,y), cosd(x), cpulimit(x), eval(s),\n"
	print "\t\terrbits(x,y), expm1(x), exponent(x), factorial(x),\n"
	print "\t\tfloor(x), fmod(x,y), gcd(x,y), getenv(s), hexfp(x),\n"
	print "\t\thexint(x), hypot(x,y), ilogb(x), index(s,t),\n"
	print "\t\tisfinite(x), isinf(x), isnan(x), isnormal(x), isqnan(x),\n"
	print "\t\tissnan(x), issubnormal(x), J0(x), J1(x), Jn(n,x),\n"
	print "\t\tJn(x,y), lcm(x,y), ldexp(x,y), length(s), lgamma(x),\n"
	print "\t\tload(file), log1p(x), log2(x) logfile(file), logoff(),\n"
	print "\t\tlogon(), macheps(x), max(x,y), maxnormal(), min(x,y),\n"
	print "\t\tminnormal(), minsubnormal(), nearest(x,y),\n"
	print "\t\tnextafter(x,y), nint(x), now(), number(s),\n"
	print "\t\tprintenv(prefix), putenv(s,v), rand(x), randint(x,y),\n"
	print "\t\trandl(x), remainder(x,y), rint(x), rsqrt(x),\n"
	print "\t\tsave(file,prefix), scalb(x,y), second(), setrand(x),\n"
d208 3
a210 3
	print "\t\tsystime(), tan(x), tand(x), tanh(x), tolower(s),\n"
	print "\t\ttoupper(s), trunc(x), Y0(x), Y1(x), Yn(n,y), and\n"
	print "\t\tYn(x,y).\n\n"
d214 15
a228 11
	print "New command-line options: --author, --?, --copyright, --help,\n"
	print "\t\t--no-banner, --no-help-file, --no-load, --no-logfile,\n"
	print "\t\t--no-readline, --no-save --no-site-file,\n"
	print "\t\t--no-translation-file, --no-user-file, --quick,\n"
	print "\t\t--silent, --version.\n\n"

	print "New constants and variables: __CPU_LIMIT__, __DATE__, __FILE__,\n"
	print "\t\t__FILE__[*], __IEEE_754__, __LINENO__,\n"
	print "\t\t__PACKAGE_BUGREPORT__, __PACKAGE_DATE__,\n"
	print "\t\t__PACKAGE_NAME__, __PACKAGE_STRING__,\n"
	print "\t\t__PACKAGE_VERSION__, __PROMPT__, __TIME__,\n"
d244 3
a246 3
	print "before running hoc.  Currently, codes da (Danish), de (German),\n"
	print "en (English), fr (French), hr (Croatian), pt (Portuguese), and\n"
	print "tr (Turkish) are supported.\n\n"
@


1.7
log
@Add load of pushd library.
@
text
@d319 1
a319 1
proc __set_locale() \
a320 5
# This does not work yet: strings cannot yet be arguments to user-defined func/proc 
#	__OLD_LANG__ = putenv("LANG",$1)
#	load(__SYSHOCDIR__ "/" $1 "/hoc.rc")
#	load(__SYSHOCDIR__ "/" $1 "/help.hoc")
#	load(__SYSHOCDIR__ "/" $1 "/translations.hoc")
d330 1
a330 1
proc danish ()		{ __LANG__ = "da"; __set_locale() }
d334 1
a334 1
proc english()		{ __LANG__ = "en"; __set_locale() }
d341 1
a341 1
proc ingles()		{ english() }	# simplified es/pt 
d346 1
a346 1
proc french ()		{ __LANG__ = "fr"; __set_locale() }
d351 1
a351 1
proc german()		{ __LANG__ = "de"; __set_locale() }
d355 1
a355 1
proc croatian()		{ __LANG__ = "hr"; __set_locale() }
d358 1
a358 1
proc portuguese()	{ __LANG__ = "pt"; __set_locale() }
d362 1
a362 1
proc spanish()		{ __LANG__ = "es"; __set_locale() }
d367 1
a367 1
proc turkish()		{ __LANG__ ="tr"; __set_locale() }
@


1.6
log
@Routine update
@
text
@d385 3
@


1.5
log
@Update news() to mention that Croatian is now supported.
@
text
@d2 1
a2 1
### /usr/local/src/hoc/hoc-7.0.0.beta/hoc.rc, Mon Dec 17 09:20:57 2001
d218 1
a218 2
	print "\t\t__FILE__[*], __IEEE_754__, __LINENO__, __MAX_NAME__,\n"
	print "\t\t__MAX_PUSHBACK__, __MAX_STRING__, __MAX_TOKEN__,\n"
d254 1
a254 3
	## TO DO: replace this by __PACKAGE_xx__ variables
	print "This is hoc version 7.0.0.beta [15-Dec-2001].\n"
	## print "This is ", __PACKAGE_NAME__, " version ", __PACKAGE_VERSION__, "[", __PACKAGE_DATE__, "].\n"
d319 1
a319 1
proc __set_language() \
d335 1
a335 1
proc danish ()		{ __LANG__ = "da"; __set_language() }
d339 1
a339 1
proc english()		{ __LANG__ = "en"; __set_language() }
d347 2
d351 1
a351 1
proc french ()		{ __LANG__ = "fr"; __set_language() }
d356 1
a356 1
proc german()		{ __LANG__ = "de"; __set_language() }
d360 4
a363 1
proc portuguese()	{ __LANG__ = "pt"; __set_language() }
d367 1
a367 1
proc spanish()		{ __LANG__ = "es"; __set_language() }
d372 3
a374 2
proc turkish()		{ __LANG__ ="tr"; __set_language() }
## TO DO: Add Turkish name for Turkish
d378 6
a383 5
### proc bailout()		exit($1)
### proc bye()		exit($1)
### proc byebye()		exit($1)
### proc goodbye()		exit($1)
### proc quit()		exit($1)
@


1.4
log
@Add new __set_language() procedure, and a collection of functions
to invoke it, allowing language switching in the middle of a hoc
session.  The code in __set_language() will be cleaned up when
grammar changes are made to allow user-defined functions to get
string arguments.
@
text
@d239 2
a240 2
	print "en (English), fr (French), pt (Portuguese), and tr (Turkish) are\n"
	print "supported.\n\n"
@


1.3
log
@Correct the commented-out macheps() function to correctly handle
the case of x == MAXNORMAL (a similar fix was done in Macheps()
in ieee754.c).

Update news().
@
text
@d318 63
@


1.2
log
@Comment out macheps() function, since it is now in the hoc kernel.
Add maxnormal(), minnormal(), minsubnormal() functions (later
added to kernel as predefined constants).
Make various minor tweaks.
@
text
@d113 2
a114 2
### OLD		{	# Generate NaN by subtracting infinities
### OLD			__epsilon = __x - __epsilon
d117 1
a117 4
### OLD		{
### OLD			__epsilon = __x + __epsilon
### OLD			__epsilon = __epsilon - __x
### OLD		}
d188 20
a207 10
	print "New functions: acosh(x), asinh(x), atanh(x), cbrt(x), copysign(x,y),\n"
	print "\t\tcosd(x), errbits(), expm1(x), factorial(x), fmod(x,y), gcd(x,y),\n"
	print "\t\thypot(x,y), ilogb(x), isfinite(x), isinf(x), isnan(x),\n"
	print "\t\tisnormal(x), isqnan(x), issnan(x), issubnormal(x),\n"
	print "\t\tJ0(x), J1(x), Jn(x,y), lcm(x,y), ldexp(x,y), lgamma(x),\n"
	print "\t\tlog1p(x), macheps(x), max(x,y), min(x,y), nearest(x,y),\n"
	print "\t\tnextafter(x,y), rand(x), randint(x,y), randl(x),\n"
	print "\t\tremainder(x,y), rint(x), rsqrt(x), scalb(x,y),\n"
	print "\t\tsetrand(x), significand(x), sind(x), tand(x), trunc(x),\n"
	print "\t\tY0(x), Y1(x), and Yn(x,y).\n\n"
d211 13
a223 7
	print "New command-line options: --author, --help, --no-help-file,\n"
	print "\t\t--no-site-file, --no-user-file, --silent, --version.\n\n"

	print "New constants and variables: __DATE__, __FILE__, __FILE__[*],\n"
	print "\t\t__IEEE_754__, __LINENO__, __PACKAGE_BUGREPORT__,\n"
	print "\t\t__PACKAGE_DATE__, __PACKAGE_NAME__, __PACKAGE_STRING__,\n"
	print "\t\t__PACKAGE_VERSION__, __PROMPT__, __TIME__, __VERBOSE__\n\n"
d237 4
a240 3
	print "LC_ALL environment variable to a suitable locale code before\n"
	print "running hoc.  Currently, codes da (Danish), de (German) and fr (French)\n"
	print "are supported.\n\n"
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
### /usr/local/src/hoc/hoc-7.0.0.beta/hoc.rc, Thu Dec  6 06:51:06 2001
d19 1
a19 1
### [08-Dec-2001]
d85 38
a122 33
func macheps() \
{
	## NB: This code guarantees these results:
	##	macheps(Inf)  -> NaN
	##	macheps(-Inf) -> NaN
	##	macheps(NaN)  -> NaN
	##	macheps(-NaN) -> -NaN

	__x = $1
	if (isnan(__x)) \
		return (__x)

	if (__x == 0) \
		__epsilon = 1.0 \
	else \
		__epsilon = abs(__x)

	while ((__x + __epsilon/2.0) != __x) \
		__epsilon /= 2.0

	# purify __epsilon to eliminate all but high-order bit
	__temp = __x + __epsilon
	if (isinf(__temp)) \
	{	# Generate NaN by subtracting infinities
		__epsilon = __x - __epsilon
	} \
	else \
	{
		__epsilon = __x + __epsilon
		__epsilon = __epsilon - __x
	}
	return (__epsilon)
}
d161 1
d168 2
a169 1
	print "\tLCCN: QA76.76.O63 K48 1984\n\n"
d171 9
a179 3
	print "statements, and functions, initialization files, and GNU readline\n"
	print "support were added by:\n\n"
	print "\tNelson H. F. Beebe <beebe@@math.utah.edu>\n"
d186 1
a186 1
	print "[08-Dec-2001]\n"
d190 1
d192 1
a192 1
	print "\t\tcosd(x), expm1(x), factorial(x), fmod(x,y), gcd(x,y),\n"
d197 4
a200 4
	print "\t\tnextafter(x,y), ran(x), randl(x), remainder(x,y),\n"
	print "\t\trint(x), rsqrt(x), scalb(x,y), setran(x),\n"
	print "\t\tsignificand(x), sind(x), tand(x), trunc(x), Y0(x),\n"
	print "\t\tY1(x), and Yn(x,y).\n\n"
d212 6
d225 2
a226 2
	print "running hoc.  Currently, codes da (Danish) and fr (French) are\n"
	print "supported.\n\n"
d228 6
a233 2
	print "GNU readline support is available for convenient command recall.  Visit\n"
	print "GNU emacs info node readline (C-h i mreadline) for details.\n"
d242 1
a242 1
	print "This is hoc version 7.0.0.beta [08-Dec-2001].\n"
d253 53
a305 2
### Print a welcome banner if option --silent was not specified:
if (__VERBOSE__) _internal_welcome()
@
