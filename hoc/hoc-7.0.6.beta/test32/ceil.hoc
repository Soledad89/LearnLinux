### -*-hoc-*-
### ====================================================================
### Test ceil().
### [10-Dec-2001]
### ====================================================================

proc scaled_ceil_check(a) \
{
	global __SCALE__, __TEST__
	x = __SCALE__ * a

	## print "DEBUG 1:", a, __SCALE__, x, "\n"

	## d = ceil(x) - x

	__TEST__ = "abs(ceil(x) - x) < 1"
	__assert   (abs(ceil(x) - x) < 1)

	## print "DEBUG 2:", a, __SCALE__, x, "\n"

	__TEST__ = "ceil(x) >= x"
	__assert   (ceil(x) >= x)

	if (ceil(x) == int(x)) \
	{
	} \
	else \
	{
		if (x >= 0) \
		{
			__TEST__ = "ceil(x) == int(x + 1)"
			__assert   (ceil(x) == int(x) + 1)
		} \
		else \
		{
			__TEST__ = "ceil(x) == int(x)"
			__assert   (ceil(x) == int(x))
		}
	}
	## print "DEBUG 3:", a, __SCALE__, x, "\n"
}

__n = -log2(macheps(1))

for (__k = 1 ; __k <= __n; ++__k) \
{
	__SCALE__ = 2^__k
	scaled_ceil_check(2 + 2^-__k)
	scaled_ceil_check(2 - 2^-__k)
	scaled_ceil_check(1 + 2^-__k)
	scaled_ceil_check(1 - 2^-__k)
	scaled_ceil_check(0 + 2^-__k)
	scaled_ceil_check(0 - 2^-__k)
}

__TEST__ = "isnan(ceil(NaN))"
__assert   (isnan(ceil(NaN)))

__TEST__ = "isnan(ceil(-NaN))"
__assert   (isnan(ceil(-NaN)))

__TEST__ = "isinf(ceil(Inf))"
__assert   (isinf(ceil(Inf)))

__TEST__ = "isinf(ceil(-Inf))"
__assert   (isinf(ceil(-Inf)))
