### -*-hoc-*-
### ====================================================================
### Test hoc's call stack depth.
### [13-Dec-2001]
### ====================================================================

### Each hoc call level also involves two call levels in C in the hoc
### kernel.  Experiments on Sun Solaris showed that 224 bytes of C stack
### space were needed for each hoc call, which corresponds to about 4680
### calls per megabyte of C stack space.
###
### Since stack space is fixed on some operating systems, or limited by
### user-definable parameters on UNIX-like systems (e.g., the "limit" or
### "ulimit -a" commands on Sun Solaris and several different GNU/Linux
### systems show a default stack of 8MB, and other systems went from a
### default low of 0.5MB (Apple Darwin) to a high of 64MB (FreeBSD and
### SGI IRIX) ), we cannot make the test depth arbitrarily large without
### risking C stack space exhaustion, giving premature test failure on
### some systems, and not on others.
###
### If we assume all modern systems have at least 0.25MB of stack space,
### then a reasonable limit for this test is about 1000.

depth = 0
max_depth = 1000

proc deep_call() \
{
	global depth, max_depth
	if (depth < max_depth) \
	{
		print ++depth, "\n"
		deep_call()
	}
}

deep_call()
